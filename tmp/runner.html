<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script type="text/javascript" src="browserfs.js"></script>
    <script type="text/javascript" src="require.js"></script>
    <script type="text/javascript">
        BrowserFS.install(window);
        window.results = [];
        require(['./event_logger'], function (event_logger) {
            var benchmarks = ['javap'],//['bananabread_arena', 'bananabread_lavarooms', 'javap', 'latex_example', 'scummvm_samnmax'],
                i = 0;
            function next_bench() {
                // Done.
                if (i === (benchmarks.length * 4)) return alert("Done.");
                var bench = benchmarks[Math.floor(i / 4)];
                i++;
                var xhrfs = new BrowserFS.FileSystem.XmlHttpRequest('./listings.json', '.', new InMemoryCache(40*1024*1024));
                BrowserFS.initialize(xhrfs);
                process.chdir(bench);
                new event_logger.EventReplay(bench, function (time) {
                    results.push(time);
                    results.push(xhrfs.cache.hitRate());
                    process.chdir('..');
                    next_bench();
                });
            }
            next_bench();
        });
    </script>
    <meta charset="utf-8" />
    <title>Runner</title>
</head>
<body>

</body>
</html>